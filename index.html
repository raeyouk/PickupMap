<!DOCTYPE html>

<head>
  <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
  <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
  <title>PickupMap</title>
  <style>
    /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
    #map {
      height: 70%;
      width: 75%;
      margin: 0 auto 0 auto;
    }

    /* Optional: Makes the sample page fill the window. */
    html,
    body {
      height: 100%;
      margin: 0;
      padding: 0;
      overflow-y: hidden;
    }

    #description {
      font-family: Roboto;
      font-size: 15px;
      font-weight: 300;
    }

    #infowindow-content .title {
      font-weight: bold;
    }

    #infowindow-content {
      display: none;
    }

    #map #infowindow-content {
      display: inline;
    }

    .pac-card {
      margin: 10px 10px 0 0;
      border-radius: 2px 0 0 2px;
      box-sizing: border-box;
      -moz-box-sizing: border-box;
      outline: none;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
      background-color: #fff;
      font-family: Roboto;
    }

    #pac-container {
      padding-bottom: 12px;
      margin-right: 12px;
    }

    .pac-controls {
      display: inline-block;
      padding: 5px 11px;
    }

    .pac-controls label {
      font-family: Roboto;
      font-size: 13px;
      font-weight: 300;
    }

    #pac-input {
      background-color: #fff;
      font-family: Roboto;
      font-size: 20px;
      font-weight: 300;
      margin-top: 10px;
      margin-left: 50px;
      padding: 0 11px 0 13px;
      text-overflow: ellipsis;
      height: 35px;
      width: 400px;
    }

    #pac-input:focus {
      border-color: #4d90fe;
    }

    #title {
      color: #fff;
      background-color: #4d90fe;
      font-size: 25px;
      font-weight: 500;
      padding: 6px 12px;
    }

    #target {
      width: 345px;
    }

    /* Switch */
    .switch {
      position: absolute;
      top: 10px;
      left: 10px;
      display: inline-block;
      width: 60px;
      height: 34px;

    }

    /* Hide default HTML checkbox */
    .switch input {
      opacity: 0;
      width: 0;
      height: 0;

    }

    /* The slider */
    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #ccc;
      -webkit-transition: .4s;
      transition: .4s;
    }

    .slider:before {
      position: absolute;
      content: "";
      height: 26px;
      width: 26px;
      left: 4px;
      bottom: 4px;
      background-color: white;
      -webkit-transition: .4s;
      transition: .4s;
    }

    input:checked+.slider {
      background-color: rgb(0, 0, 0);
    }

    input:focus+.slider {
      box-shadow: 0 0 0 3px rgb(255, 255, 255);
    }

    input:checked+.slider:before {
      -webkit-transform: translateX(26px);
      -ms-transform: translateX(26px);
      transform: translateX(26px);
    }

    /* Rounded sliders */
    .slider.round {
      border-radius: 34px;
    }

    .slider.round:before {
      border-radius: 50%;
    }

    /* .slider::after {
      position: relative;
      right: -70px;
      width: 8800px;
      content: "Enable dark mode"
    } */
  </style>
</head>

<html>

<body>
  <h2 class="text" style="font-family:helvetica; font-size:60px; text-align: center;">Find<span
      style="color:#ff00bf;">My</span><span>Ride</span>
  </h2>

  <label class="switch">
    <input id="toggle" type="checkbox" onchange="toggled()">
    <span class="slider round"></span>
  </label>
  <div class="text" style="font-family:helvetica; font-size:12px;  position: absolute; top: 20px; left: 80px">Dark mode
  </div>

  <form id="form1">
    <button id="btn1" onclick="whichButton(this)">Button 1</button><br />
    <!-- <button id="btn2" onclick="whichButton(this)">Button 2</button><br/>
    <button id="btn3" onclick="whichButton(this)">Button 3</button><br/>
    <button id="btn4" onclick="whichButton(this)">Button 4</button><br/> -->
  </form>


  <input id="pac-input" class="controls" type="text" placeholder="Search">

  <div id="map"></div>
  <script>
    var customLabel = {
      Uber: {
        //   url: 'http://localhost/PickupMap/icons/uber',
        url: 'http://localhost/PickupMap/icons/ubersmall',
        //   scaledSize : new google.maps.Size(50, 50)
      },
      Lyft: {
        //   url: 'http://localhost/PickupMap/icons/lyft',
        url: 'http://localhost/PickupMap/icons/lyftsmall',
      },
    };

    var map;
    var markers = [];
    var infoWindow;

    function initAutocomplete() {
      map = new google.maps.Map(document.getElementById('map'), {
        center: { lat: 40.7128, lng: -74.0060 },
        zoom: 13,
        mapTypeId: 'roadmap'
      });

      // Create the search box and link it to the UI element.
      var input = document.getElementById('pac-input');
      var searchBox = new google.maps.places.SearchBox(input);
      map.controls[google.maps.ControlPosition.TOP_LEFT].push(input);

      // Bias the SearchBox results towards current map's viewport.
      map.addListener('bounds_changed', function () {
        searchBox.setBounds(map.getBounds());
      });

      // var markers = [];

      // Listen for the event fired when the user selects a prediction and retrieve
      // more details for that place.
      searchBox.addListener('places_changed', function () {
        var places = searchBox.getPlaces();

        if (places.length == 0) {
          return;
        }

        // Clear out the old markers.
        markers.forEach(function (marker) {
          marker.setMap(null);
        });
        markers = [];

        // For each place, get the icon, name and location.
        var bounds = new google.maps.LatLngBounds();
        places.forEach(function (place) {
          if (!place.geometry) {
            console.log("Returned place contains no geometry");
            return;
          }
          var icon = {
            url: place.icon,
            size: new google.maps.Size(71, 71),
            origin: new google.maps.Point(0, 0),
            anchor: new google.maps.Point(17, 34),
            scaledSize: new google.maps.Size(50, 50)
          };

          // Create a marker for each place.
          markers.push(new google.maps.Marker({
            map: map,
            icon: 'http://maps.google.com/mapfiles/ms/icons/red-dot.png',
            title: place.name,
            position: place.geometry.location
          }));

          if (place.geometry.viewport) {
            // Only geocodes have viewport.
            bounds.union(place.geometry.viewport);
          } else {
            bounds.extend(place.geometry.location);
          }
        });
        map.fitBounds(bounds);
      });

      infoWindow = new google.maps.InfoWindow;

      // downloadUrl('http://localhost/PickupMap/conn.php', function (data) {
      //   var xml = data.responseXML;
      //   var markers = xml.documentElement.getElementsByTagName('marker');
      //   Array.prototype.forEach.call(markers, function (markerElem) {
      //     var id = markerElem.getAttribute('id');
      //     //   var name = markerElem.getAttribute('name');
      //     var timeanddate = markerElem.getAttribute('timeanddate');
      //     var company = markerElem.getAttribute('company');
      //     var point = new google.maps.LatLng(
      //       parseFloat(markerElem.getAttribute('lat')),
      //       parseFloat(markerElem.getAttribute('lng')));

      //     var infowincontent = document.createElement('div');
      //     var strong = document.createElement('strong');
      //     //   strong.textContent = name
      //     strong.textContent = "Pickup Time:"
      //     infowincontent.appendChild(strong);
      //     infowincontent.appendChild(document.createElement('br'));

      //     var text = document.createElement('text');
      //     text.textContent = timeanddate
      //     infowincontent.appendChild(text);
      //     var pin = customLabel[company] || {};

      //     // if (id < 5) {
      //     var marker = new google.maps.Marker({
      //       map: map,
      //       position: point,
      //       icon: pin
      //     });
      //     // }
      //     // markers[2].setMap(null);
      //     // delete marker[0];
      //     // delete marker[1];
      //     // delete marker[2];
      //     // delete marker[3];
      //     // clearMarkers();
      //     // showMarkers();

      //     marker.addListener('click', function () {
      //       infoWindow.setContent(infowincontent);
      //       infoWindow.open(map, marker);
      //     });
      //   });
      // });

      // function setMapOnAll(map) {
      //   for (var i = 0; i < markers.length; i++) {
      //     markers[i].setMap(map);
      //   }
      // }

      // function clearMarkers() {
      //   setMapOnAll(null);
      // }

      // function showMarkers() {
      //   setMapOnAll(map);
      // }

    } //initautocomplete



    // function whichButton(buttonElement) {
    //   // alert(buttonElement.id);
    //   var buttonClickedId = buttonElement.id;
    //   if (buttonClickedId === 'btn1') {

    //     // downloadUrl('http://localhost/PickupMap/conn.php', function (data) {
    //     //   var xml = data.responseXML;
    //     //   var markers = xml.documentElement.getElementsByTagName('marker');
    //     //   Array.prototype.forEach.call(markers, function (markerElem) {
    //     //     var id = markerElem.getAttribute('id');
    //     //     //   var name = markerElem.getAttribute('name');
    //     //     var timeanddate = markerElem.getAttribute('timeanddate');
    //     //     var company = markerElem.getAttribute('company');
    //     //     var point = new google.maps.LatLng(
    //     //       parseFloat(markerElem.getAttribute('lat')),
    //     //       parseFloat(markerElem.getAttribute('lng')));

    //     //     var infowincontent = document.createElement('div');
    //     //     var strong = document.createElement('strong');
    //     //     //   strong.textContent = name
    //     //     strong.textContent = "Pickup Time:"
    //     //     infowincontent.appendChild(strong);
    //     //     infowincontent.appendChild(document.createElement('br'));

    //     //     var text = document.createElement('text');
    //     //     text.textContent = timeanddate
    //     //     infowincontent.appendChild(text);
    //     //     var pin = customLabel[company] || {};

    //     //     // if (id < 5) {
    //     //     var marker = new google.maps.Marker({
    //     //       map: map,
    //     //       position: point,
    //     //       icon: pin
    //     //     });
    //     //     // }

    //     //     marker.addListener('click', function () {
    //     //       infoWindow.setContent(infowincontent);
    //     //       infoWindow.open(map, marker);
    //     //     });
    //     //   });
    //     // });

    //   }
    //   else if (buttonClickedId === 'btn2') {
    //     // do btn2 stuff
    //   }
    //   // ...
    //   else {
    //     // don't know which button was clicked
    //   }
    // }


    function downloadUrl(url, callback) {
      var request = window.ActiveXObject ?
        new ActiveXObject('Microsoft.XMLHTTP') :
        new XMLHttpRequest;

      request.onreadystatechange = function () {
        if (request.readyState == 4) {
          request.onreadystatechange = doNothing;
          callback(request, request.status);
        }
      };

      request.open('GET', url, true);
      request.send(null);
    }

    function doNothing() { }

    // initAutocomplete();
  </script>

  <!-- Toggle switch -->
  <script>
    function toggled() {
      var text = document.getElementsByClassName("text");
      if (document.getElementById("toggle").checked) {
        document.body.style.backgroundColor = "black";
        for (var i = 0; i < text.length; i++) {
          text[i].style.color = 'white';
        }
      }
      else {
        document.body.style.backgroundColor = "white";
        for (var i = 0; i < text.length; i++) {
          text[i].style.color = 'black';
        }
      }
      downloadUrl('http://localhost/PickupMap/conn.php', function (data) {
        var xml = data.responseXML;
        var markers = xml.documentElement.getElementsByTagName('marker');
        Array.prototype.forEach.call(markers, function (markerElem) {
          var id = markerElem.getAttribute('id');
          //   var name = markerElem.getAttribute('name');
          var timeanddate = markerElem.getAttribute('timeanddate');
          var company = markerElem.getAttribute('company');
          var point = new google.maps.LatLng(
            parseFloat(markerElem.getAttribute('lat')),
            parseFloat(markerElem.getAttribute('lng')));

          var infowincontent = document.createElement('div');
          var strong = document.createElement('strong');
          //   strong.textContent = name
          strong.textContent = "Pickup Time:"
          infowincontent.appendChild(strong);
          infowincontent.appendChild(document.createElement('br'));

          var text = document.createElement('text');
          text.textContent = timeanddate
          infowincontent.appendChild(text);
          var pin = customLabel[company] || {};

          // if (id < 5) {
          var marker = new google.maps.Marker({
            map: map,
            position: point,
            icon: pin
          });
          // }
          // markers[2].setMap(null);
          // delete marker[0];
          // delete marker[1];
          // delete marker[2];
          // delete marker[3];
          // clearMarkers();
          // showMarkers();

          marker.addListener('click', function () {
            infoWindow.setContent(infowincontent);
            infoWindow.open(map, marker);
          });
        });
      });

    }
  </script>

  <!-- API -->
  <script
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBj-r4sHkXI-faO_soZFTfSsBn0QPNpgmQ&libraries=places&callback=initAutocomplete"
    async defer></script>

</body>
<div class="text" style="font-family:helvetica; font-size:10px;  position: absolute; bottom: 5px;">&nbsp; Made by
  Young-Rae Kim, Samantha Axline, and Sreeja Kondeti &nbsp;</div>

</html>